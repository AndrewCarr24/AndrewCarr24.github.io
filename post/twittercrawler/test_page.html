<!DOCTYPE html>
<html lang="en-us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>
				Introducing twittercrawler &middot; Data Diarist
		</title>


  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">


		<link href="" rel="alternate" type="application/rss+xml" title="Data Science Diarist" />
	</head>

    <body>



<nav class="nav">
  <div class="nav-container">
      <a href="/">
        <h2 class="nav-title" style="font-size:32px">Andrew Carr </h2>
      </a>
      <a href="https://github.com/AndrewCarr24">
          <i class="fa fa-github" style="font-size:32px"></i>
      </a>
      <a href="https://twitter.com/Andrew_Carr24">
          <i class="fa fa-twitter" style="font-size:32px"></i>
      </a>
      <a href="https://www.linkedin.com/in/andrew-carr24">
          <i class="fa fa-linkedin" style="font-size:32px"></i>
      </a>
    <ul>
      <li><a href="/about" style="font-size:20px">About</a></li>
      <li><a href="/shiny" style="font-size:20px">Shiny</a></li>
      <li><a href="/Dataviz" style="font-size:20px">Data Viz</a></li>
    </ul>
  </div>
</nav>

 <link rel="stylesheet"
href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/github.min.css">
 <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js">
</script> <script>hljs.initHighlightingOnLoad();</script>



<main>
	<div class="post">
		<div class="post-info">
    <span>Written by Andrew Carr</span>

        <br>
        <span>on&nbsp;</span><time datetime="2019-11-01 00:00:00 &#43;0000 UTC">November 1, 2019</time>
</div>
		<h1 class="post-title">Introducing the twittercrawler package</h1>
<div class="post-line"></div>

<p>The Twitter API is a great tool for researchers interested in analyzing discourse and social network processes on Twitter. In this post, I introduce a new R package, twittercrawler, which automates the process of collecting social network data through the Twitter API. To use twittercrawler, you will need API credentials. You can apply for these through Twitter’s developer pages <a href="https://developer.twitter.com/en/docs/twitter-api/getting-started/guide">developer.twitter.com/en/docs/twitter-api/getting-started/guide</a>.</p>
<p>Currently, you can install the twittercrawler package through my Github page.</p>
<pre class="r"><code>devtools::install_github(&quot;AndrewCarr24/twittercrawler&quot;)
library(twittercrawler)</code></pre>
<p>To begin, load the package and enter your API credentials into the api_credentials_to_token function.</p>
<pre class="r"><code>app_name &lt;- #### App name
consumer_key &lt;- #### Consumer key
consumer_secret &lt;- #### Consumer secret
access_token &lt;- #### Access token
access_secret &lt;- #### Access secret

api_token &lt;- api_credentials_to_token(app_name, consumer_key, consumer_secret, access_token, access_secret)</code></pre>
<p>The twittercrawler package has one main function: get_user_network. This function requires three parameters. The first parameter, screen_name, is the screen name of the Twitter user you want to collect network data from. The second required parameter, degrees, is the number of “degrees out” you want twittercrawler to go (more on this in a moment). Finally, the token parameter takes the API token returned from api_credentials_to_token.</p>
<p>Let’s go through example to clarify what these parameters mean. Let’s say I want to collect two degrees of network data for myself. I run the following line of code.</p>
<pre class="r"><code>user_content &lt;- get_user_network(screen_name = &quot;Andrew_Carr24&quot;, degree = 2, token = api_token)</code></pre>
<p>This function returns a named list containing two items: a dataframe (nodes) with user information for my Twitter friends and my friends’ friends - in other words, everyone two degrees removed from me on Twitter - and another dataframe (edgelist) indicating ties among these users.</p>
<pre class="r"><code>user_content</code></pre>
<pre><code>## $nodes
## # A tibble: 85,757 x 10
##    id     screen_name  name  friends_count followers_count location description
##    &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;         &lt;int&gt;           &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;
##  1 77861… Andrew_Carr… Andr…            94             104 &quot;Durham… &quot;Sociology …
##  2 12716… RStatsJobsB… RSta…             1             707 &quot;&quot;       &quot;Are you lo…
##  3 53854… CarenArbeit  Dr. …           228             401 &quot;San Fr… &quot;Sociologis…
##  4 30922… Effect_Altr… Effe…            60           15355 &quot;&quot;       &quot;#effective…
##  5 36300… willmacaski… Will…          1183           27492 &quot;Oxford&quot; &quot;Assoc Prof…
##  6 46955… GrahamDavidA Davi…          1887           34253 &quot;Durham… &quot;\&quot;Dispirit…
##  7 16017… NateSilver5… Nate…          1378         3642961 &quot;New Yo… &quot;Founder, E…
##  8 11699… SamHarrisOrg Sam …           553         1470122 &quot;&quot;       &quot;Author of …
##  9 10448… i_zzzzzz     Broo…           842           33899 &quot;Montre… &quot;Send me yo…
## 10 65934… eidlin       Barr…          1818            2650 &quot;Montré… &quot;Former org…
## # … with 85,747 more rows, and 3 more variables: url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;, degree &lt;dbl&gt;
##
## $edges
## # A tibble: 120,094 x 2
##    from               to
##    &lt;chr&gt;              &lt;chr&gt;
##  1 778619636510326784 1271627871098941441
##  2 778619636510326784 538544281
##  3 778619636510326784 3092297686
##  4 778619636510326784 363005534
##  5 778619636510326784 46955476
##  6 778619636510326784 16017475
##  7 778619636510326784 116994659
##  8 778619636510326784 10448062
##  9 778619636510326784 65934237
## 10 778619636510326784 749397927462703105
## # … with 120,084 more rows</code></pre>
<p>Note that there are over 80,000 users within two degrees of me. This is no surprise. Some of my friends on Twitter have thousands of friends, and all of these friends end up in this dataframe.</p>
<p>In the code below, I limit the user dataframe and edgelist to users who are just one degree away from me. The “degree” column indicates the degrees of separation, so I can simply filter the dataframes to include only nodes that are fewer than 2 degrees away from me.</p>
<pre class="r"><code># Getting nodes and edgelist
node_tbl &lt;- user_content[[1]]
edgelist_tbl &lt;- user_content[[2]]

# Limiting dataframes to nodes one degree away
node_tbl &lt;- node_tbl %&gt;% filter(degree &lt; 2)
node_ids &lt;- node_tbl %&gt;% pull(id)
edgelist_tbl &lt;- edgelist_tbl %&gt;% filter(from %in% node_ids &amp; to %in% node_ids)</code></pre>
<p>Why didn’t I just only collect users one degree away from me in the first place? The advantage of collecting users two degrees out and then dropping the 2nd degree users is that the resulting edgelist includes ties among the friends that are one degree removed from me. Let’s look at the resulting network.</p>
</div>

<iframe src="test_widget.html" width="100%" height="550" scrolling="no" frameborder="0"></iframe>



</div>

<script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</div>

<div class="pagination">
<a href="/post/mapping-the-underlying-social-structure-of-reddit" class="left arrow">&#8592;</a>

<a href="#" class="top">Top</a>
</div>
</main>


        <footer>
    <span>
    &copy; <time datetime="2019-11-01 14:08:56.250447 -0400 EDT m=&#43;6.662286260">2021</time> Andrew Carr. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
    </span>
</footer>

</body>
</html>
